{% extends "bootstrap/base.html" %}
{% block title %}Heart Disease Prediction{% endblock %}

{% block styles %}
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

<link href="{{url_for('static', filename='css/results.css')}}" rel="stylesheet">
<link href="{{url_for('static', filename='css/index-page.css')}}" rel="stylesheet">
<link href="{{url_for('static', filename='css/top-navbar.css')}}" rel="stylesheet">
<link href="{{url_for('static', filename='css/form-section.css')}}" rel="stylesheet">
{% endblock %}


{% block navbar %}
<nav class="navbar navbar-expand-lg sticky-top navbar-dark bg-dark">
  <div class="container-fluid">

      <a class="img-heart">
            <img src="{{url_for('static', filename='assets/Heart-noBG.svg')}}" width="30" height="30" class="img-fluid" alt="Heart_Png">
      </a>

      <a class="navbar-brand" href="#">Disease Prediction</a>

      <button class="navbar-toggler collapsed d-flex d-lg-none flex-column justify-content-around" type="button" data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false" aria-label="Toggle navigation">

          <span class="toggler-icon top-bar"></span>
          <span class="toggler-icon middle-bar"></span>
          <span class="toggler-icon bottom-bar"></span>

      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">

          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                  <a class="nav-link active" aria-current="page" href="#">Learn More</a>
              </li>
              <li class="nav-item">
                  <a href="#" style="color: red;" class="nav-link active" data-bs-toggle="offcanvas"
                     data-bs-target="#offcanvasWithBackdrop" aria-controls="offcanvasWithBackdrop" >What Do I Input?</a>
              </li>
          </ul>

      </div>

  </div>
</nav>
{% endblock %}


{% block body %}
{{super()}}
<body>
    <!-- Pop out (Input Section Description)-->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasWithBackdrop" aria-labelledby="offcanvasWithBackdropLabel">
        <!-- Header Information for the Variables -->
        <div class="offcanvas-header">
            <h2 class="offcanvas-title" id="offcanvasWithBackdropLabel" >Input Requirements</h2>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="accordion accordion-flush" id="accordionFlushExample">
                <!-- Explaining the Age Variable -->
                <div class="accordion-item">
                    <h1 class="accordion-header" id="flush-headingOne">
                        <button style="font-size: 17px;" class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                            Age Information
                        </button>
                    </h1>
                    <div id="flush-collapseOne" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                        <div class="accordion-body">
                            <p style="font-size: 15px;">
                                The Age section requires an integer representation of the age in years
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Explaining the Sex Variable -->
                <div class="accordion-item">
                    <h1 class="accordion-header" id="flush-headingTwo">
                        <button style="font-size: 17px;" class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwo" aria-expanded="false" aria-controls="flush-collapseTwo">
                            Sex Information
                        </button>
                    </h1>
                    <div id="flush-collapseTwo" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                        <div class="accordion-body">
                            <p style="font-size: 17px;">
                                The Sex section requires information about the biological gender. Please do <b>NOT</b> specify identified gender.
                                If birth gender is Male, please select Male. If birth gender is Female, please select Female.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Explaining the Chest Pain Variable -->
                <div class="accordion-item">
                    <h1 class="accordion-header" id="flush-headingThree">
                        <button style="font-size: 17px;" class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseThree" aria-expanded="false" aria-controls="flush-collapseThree">
                            Chest Pain Information
                        </button>
                    </h1>
                    <div id="flush-collapseThree" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">

                        <div class="accordion-body" >
                            <p style="font-size: 17px;" >
                                Angina feels like squeezing, pressure, heaviness, tightness, or pain in the chest.
                                It can be sudden or recur over time.
                                Depending on severity, it can be treated by lifestyle changes, medication, angioplasty, or surgery.
                            </p>
                            <p style="font-size: 14px;" >Value 1: typical angina</p>
                            <p style="font-size: 14px;" >Value 2: atypical angina</p>
                            <p style="font-size: 14px;" >Value 3: non-anginal pain</p>
                            <p style="font-size: 14px;" >Value 4: asymptomatic</p>
                        </div>
                    </div>
                </div>

                <!-- Explaining Angina -->
                <div class="accordion-item">
                    <h1 class="accordion-header" id="flush-headingFour">
                        <button style="font-size: 17px;" class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseFour" aria-expanded="false" aria-controls="flush-collapseFour">
                            Angina (Exersice Induced Angina)
                        </button>
                    </h1>
                    <div id="flush-collapseFour" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                        <div class="accordion-body">
                            <p style="font-size: 17px;">
                                As a simple yes or no question. We would like to know whether ot not you suffer from
                                angina while exercising.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Explaining the Oldpeak Variable -->
                <div class="accordion-item">
                    <h1 class="accordion-header" id="flush-headingSix">
                        <button style="font-size: 17px;" class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseSix" aria-expanded="false" aria-controls="flush-collapseSix">
                            Oldpeak Information
                        </button>
                    </h1>
                    <div id="flush-collapseSix" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                        <div class="accordion-body">
                            <p style="font-size: 17px;">Oldpeak =ST, please provide information using depression units</p>
                        </div>
                    </div>
                </div>

                <!-- Explaining the ST segment Variable -->
                <div class="accordion-item">
                    <h1 class="accordion-header" id="flush-headingSeven">
                        <button style="font-size: 17px;" class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseSeven" aria-expanded="false" aria-controls="flush-collapseSeven">
                            ST segment Information
                        </button>
                    </h1>
                    <div id="flush-collapseSeven" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                        <div class="accordion-body" style="font-size: 17px;">
                            <p>Value 1: upsloping</p>
                            <p>Value 2: flat</p>
                            <p>Value 3: downsloping</p>
                        </div>
                    </div>
                </div>
            </div>
      </div>
    </div>
    <!-- Pop out end -->

    <!-- Form Content Information and Response from API -->
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for message in messages %}
                <div class="prediction">
                    <div class="result-text">
                        <div class="heart-disease-result">
                            {% if message['Result'] == 0 %}
                                No Presence of Heart Disease Detected
                            {% else %}
                                Presence of Heart Disease Detected
                            {% endif %}
                        </div>
                    </div>

                    <div class="result-value">
                        <div class="total-risk">
                            {% if message['Result'] == 0 %}
                                <h2>
                                    According to the data, you have no Heart Disease;
                                    However, there is still a {{message['Total']}}%
                                    risk for Heart Disease. Please review the
                                    information below to help reduce the risk.
                                </h2>
                            {% else %}
                                <h2>
                                    According to the data, there appears to be
                                    Heart Disease detected. Please consult you primary
                                    care physical for more detailed information on the
                                    next steps to take.
                                </h2>
                            {% endif %}
                        </div>
                    </div>

                    <div class="result-info">
                        <div class="heart-disease-text">
                            Based on the factors you entered these are the likelihood
                            percentages of suffering Heart Disease based on specific
                            mutable factors. However, Heart Disease is preventable.
                            To reduce the risk of Heart Disease,
                            <a href="https://www.cdc.gov/heartdisease/prevention.htm">click me!</a> To learn more
                        </div>
                    </div>

                    <div class="row result-grid">

                        <div class="col-md-4 results">
                            <div class="card bp">
                                <h3>Blood Pressure: {{message['Systolic']}}%</h3>
                                <p>
                                    According to the <a href="https://www.cdc.gov/bloodpressure/about.htm">CDC</a>,
                                    Systolic heart rate that is 120bpm or Higher is at risk for
                                    Heart Disease. To Improve Heart Health
                                    <a href="https://www.ucihealth.org/blog/2017/02/how-to-strengthen-heart">Click Me!</a>
                                </p>
                            </div>
                        </div>

                        <div class="col-md-4 results">
                            <div class="card ecg">
                                <h3>Electrocardiogram: {{message['ECG']}}%</h3>
                                <p>
                                    Based onn our data set, {{message['ECG']}}% of individuals who had the
                                    same result had heart disease.
                                </p>
                            </div>
                        </div>

                        <div class="col-md-4 results">
                            <div class="card cp">
                                <h3>Chest Pain Level Risk: {{message['Chest']}}%</h3>
                                <p>
                                    Based onn our data set, {{message['Chest']}}% of individuals who had the
                                    same result had heart disease.
                                </p>
                            </div>
                        </div>

                    </div>
                </div>
            {% endfor %}
        {% else %}
                <form data-multi-step action="predict" method="POST" class="multi-form">
                    <!-- Field Number 1 [Age] -->

                    <div class="form-card active" data-step>
                        <div class="step-title">
                            <h3>Step 1</h3>
                        </div>
                        <div class="form-group">
                            <label>Age</label>
                            <input type="number" name="age" min="0" required>
                        </div>
                        <div class="graphic">

                        </div>
                        <button type="button" data-next >Next</button>
                    </div>

                    <!-- Field Number 2 [Sex] -->
                    <div class="form-card" data-step>
                        <div class="form-group">
                            <label>Sex</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="sex" id="validationFormCheck1" value="male" required>
                                <label class="form-check-label" for="validationFormCheck1">Male</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="sex" id="validationFormCheck2" value="female" required>
                                <label class="form-check-label" for="validationFormCheck2">Female</label>
                                <div class="invalid-feedback">Please Select a Biological Gender.</div>
                            </div>
                        </div>
                        <button type="button" data-previous >Previous</button>
                        <button type="button" data-next >Next</button>
                    </div>

                    <!-- Field Number 3 [Chest Pain Type] -->
                    <div class="form-card" data-step>
                        <div class="form-group">
                            <label>Chest Pain Type</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="chest_pain_type" id="validationFormCheck3" value="1" required>
                                <label class="form-check-label" for="validationFormCheck3">1</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="chest_pain_type" id="validationFormCheck4" value="2" required>
                                <label class="form-check-label" for="validationFormCheck4">2</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="chest_pain_type" id="validationFormCheck5" value="3" required>
                                <label class="form-check-label" for="validationFormCheck5">3</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="chest_pain_type" id="validationFormCheck6" value="4" required>
                                <label class="form-check-label" for="validationFormCheck6">4</label>
                                <div class="invalid-feedback">Please Select a Chest Pain Level.</div>
                            </div>
                        </div>
                        <button type="button" data-previous >Previous</button>
                        <button type="button" data-next >Next</button>
                    </div>

                    <!-- Field Number 4 [Exercise Angina] -->
                    <div class="form-card" data-step>
                        <div class="form-group">
                            <label>Do you suffer from exercise induced angina?</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="exercise_angina" id="validationFormCheck7" value="1" required>
                                <label class="form-check-label" for="validationFormCheck7">yes</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="exercise_angina" id="validationFormCheck8" value="2" required>
                                <label class="form-check-label" for="validationFormCheck8">no</label>
                                <div class="invalid-feedback">Please Select an option.</div>
                            </div>
                        </div>
                        <button type="button" data-previous >Previous</button>
                        <button type="button" data-next >Next</button>
                    </div>

                    <!-- Field Number 5 [oldpeak] -->
                    <div class="form-card" data-step>
                        <div class="form-group">
                            <label>What is your oldpeak level?</label>
                            <input type="number" name="oldpeak" min="0" max="6" required>
                        </div>
                        <button type="button" data-previous >Previous</button>
                        <button type="button" data-next >Next</button>
                    </div>

                    <!-- Field Number 6 [ST slope] -->
                    <div class="form-card" data-step>
                        <div class="form-group">
                            <label>What is the slope of your peak exercise ST segment?</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="ST_slope" id="validationFormCheck9" value="1" required>
                                <label class="form-check-label" for="validationFormCheck9">1</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="ST_slope" id="validationFormCheck10" value="2" required>
                                <label class="form-check-label" for="validationFormCheck10">2</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="ST_slope" id="validationFormCheck11" value="3" required>
                                <label class="form-check-label" for="validationFormCheck11">3</label>
                                <div class="invalid-feedback">Please Select an option.</div>
                            </div>
                        </div>
                        <button type="button" data-previous>Previous</button>
                        <button type="submit" value="PREDICT">Predict</button>
                    </div>

                </form>
        {% endif %}
    {% endwith %}

</body>
{% endblock %}




{% block scripts %}
<script src="{{url_for('static', filename='scripts/form.js')}}" defer ></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
{{super()}}
{% endblock %}